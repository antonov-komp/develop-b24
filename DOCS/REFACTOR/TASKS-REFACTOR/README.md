# Задачи рефакторинга

**Дата создания:** 2025-12-20 20:00 (UTC+3, Брест)  
**Версия:** 1.0  
**Описание:** Детализированные задачи для рефакторинга приложения

---

## Структура задач

### Нулевая задача (Этап 0): Миграция CRest → b24phpsdk

**Обзорный документ:** [TASK-000-crest-to-b24phpsdk-overview.md](TASK-000-crest-to-b24phpsdk-overview.md)

Детализированный план миграции с разбивкой на подзадачи:

1. **[TASK-001: Установка и настройка b24phpsdk](TASK-001-install-b24phpsdk.md)**
   - Установка через Composer
   - Настройка автозагрузки
   - Проверка загрузки классов

2. **[TASK-002: Создание Bitrix24SdkClient](TASK-002-create-sdk-client.md)**
   - Создание нового клиента
   - Реализация методов call() и callBatch()
   - Инициализация с разными типами токенов

3. **[TASK-003: Обновление Bitrix24ApiService](TASK-003-update-api-service.md)**
   - Замена Bitrix24Client на Bitrix24SdkClient
   - Обновление всех методов
   - Удаление прямых curl-вызовов

4. **[TASK-004: Миграция установки приложения](TASK-004-migrate-install.md)**
   - Обновление install.php
   - Удаление CRest::installApp()
   - Реализация установки без CRest

5. **[TASK-005: Обновление bootstrap и DI](TASK-005-update-bootstrap.md)**
   - Обновление bootstrap.php
   - Обновление всех контроллеров
   - Удаление всех require_once('crest.php')

6. **[TASK-006: Тестирование миграции](TASK-006-test-migration.md)**
   - Функциональное тестирование
   - Интеграционное тестирование
   - Тестирование производительности

7. **[TASK-007: Удаление CRest и очистка](TASK-007-remove-crest.md)**
   - Удаление файлов CRest
   - Обновление документации
   - Финальная проверка

---

## Формат задач

Каждая задача следует стандартному формату TASK-файлов:
- Описание
- Контекст
- Модули и компоненты
- Зависимости
- Ступенчатые подзадачи
- Технические требования
- Критерии приёмки
- Тестирование

---

## Порядок выполнения

**Важно:** Задачи выполняются последовательно, так как каждая зависит от предыдущей.

1. TASK-001 → Установка b24phpsdk
2. TASK-002 → Создание нового клиента
3. TASK-003 → Обновление сервисов
4. TASK-004 → Миграция установки
5. TASK-005 → Обновление bootstrap
6. TASK-006 → Тестирование
7. TASK-007 → Очистка

---

## Дополнительные детали в задачах

### Улучшения во всех задачах

**Добавлено:**
- ✅ Детальная валидация всех входных данных
- ✅ Обработка ошибок с try-catch и логированием
- ✅ Troubleshooting секции с решениями типичных проблем
- ✅ Детальные примеры кода с комментариями
- ✅ Проверка работоспособности после каждого шага
- ✅ Детали безопасности (права доступа, валидация)
- ✅ Детали логирования для диагностики

### Улучшения в конкретных задачах

**TASK-001 (Установка b24phpsdk):**
- Детали проверки установки с командами
- Troubleshooting для проблем с Composer
- Детали проверки версий SDK
- Улучшенный тестовый скрипт для проверки автозагрузки

**TASK-002 (Создание Bitrix24SdkClient):**
- Детали валидации параметров инициализации
- Детали обработки ошибок в каждом методе
- Детали преобразования ответов SDK в формат CRest
- Troubleshooting для проблем с инициализацией

**TASK-004 (Миграция установки):**
- Детали валидации входных данных
- Обработка ошибок с блокировкой файла
- Детали безопасности (права доступа, экранирование)
- Troubleshooting для проблем с записью файлов

**TASK-005 (Обновление bootstrap):**
- Детали обновления bootstrap.php с обработкой ошибок
- Детали проверки загрузки классов
- Troubleshooting для проблем с инициализацией
- Детали проверки зависимостей

---

## История правок

- **2025-12-20 20:00 (UTC+3, Брест):** Создана структура задач для рефакторинга
- **2025-12-20 20:07 (UTC+3, Брест):** Добавлены детали валидации, обработки ошибок, troubleshooting секции во все задачи

---

**Версия документа:** 1.1  
**Последнее обновление:** 2025-12-20 20:07 (UTC+3, Брест)

