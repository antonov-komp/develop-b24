# TASK-007: Удаление CRest и очистка

**Дата создания:** 2025-12-20 19:48 (UTC+3, Брест)  
**Статус:** Новая  
**Приоритет:** Высокий  
**Исполнитель:** Bitrix24 Программист (Vanilla JS)

---

## Описание

Финальная очистка проекта: удаление файлов CRest, обновление документации, удаление упоминаний CRest из кода и комментариев.

---

## Контекст

**Часть задачи:** TASK-000 (Миграция CRest → b24phpsdk)  
**Зависит от:** TASK-006 (Тестирование миграции)  
**Зависимости от этой задачи:** Нет (финальная задача)

**Цель:** Полностью удалить CRest из проекта и обновить всю документацию.

---

## Модули и компоненты

**Удаляемые файлы:**
- `APP-B24/crest.php` — библиотека CRest
- `APP-B24/settings.php` — PHP-обертка для settings.json (если не нужна)

**Обновляемые файлы:**
- `APP-B24/README.md`
- `DOCS/ARCHITECTURE/tech-stack.md`
- `DOCS/ARCHITECTURE/api-structure.md`
- Все файлы с упоминаниями CRest

---

## Зависимости

**От каких задач зависит:**
- TASK-006 (Тестирование миграции) — только после успешного тестирования

**Какие задачи зависят от этой:**
- Нет (финальная задача)

---

## Ступенчатые подзадачи

### 1. Финальная проверка использования CRest

1. **Поиск всех упоминаний CRest:**
   ```bash
   grep -r "CRest" APP-B24/
   grep -r "crest.php" APP-B24/
   grep -r "CRest" DOCS/
   ```

2. **Проверка, что все упоминания только в комментариях или документации**

3. **Составить список файлов для обновления**

### 2. Удаление файлов CRest

1. **Удалить `APP-B24/crest.php`:**
   ```bash
   rm APP-B24/crest.php
   ```

2. **Проверить `APP-B24/settings.php`:**
   - Если используется только для CRest — удалить
   - Если используется для других целей — оставить, но обновить

3. **Проверить другие файлы CRest (если есть):**
   - Удалить все файлы, связанные с CRest

### 3. Обновление документации

1. **APP-B24/README.md:**
   - Удалить упоминания CRest
   - Обновить описание библиотеки на b24phpsdk
   - Обновить примеры кода

2. **DOCS/ARCHITECTURE/tech-stack.md:**
   - Обновить описание технологического стека
   - Заменить CRest на b24phpsdk

3. **DOCS/ARCHITECTURE/api-structure.md:**
   - Обновить описание структуры API
   - Обновить примеры использования

4. **Другие документы:**
   - Найти и обновить все упоминания CRest
   - Обновить примеры кода

### 4. Обновление комментариев в коде

1. **Найти все комментарии с упоминанием CRest:**
   ```bash
   grep -r "CRest" APP-B24/src/ --include="*.php"
   ```

2. **Обновить комментарии:**
   - Заменить упоминания CRest на b24phpsdk
   - Обновить описания методов
   - Обновить примеры в комментариях

### 5. Обновление истории изменений

1. **Обновить CHANGELOG (если есть):**
   - Добавить запись о миграции
   - Указать дату завершения

2. **Обновить README:**
   - Добавить информацию о миграции
   - Обновить версию (если нужно)

### 6. Финальная проверка

1. **Повторный поиск CRest:**
   ```bash
   grep -r "CRest" APP-B24/
   # Должен вернуть только упоминания в истории или документации
   ```

2. **Проверка работоспособности:**
   - Запустить все страницы
   - Проверить логи
   - Убедиться, что нет ошибок

3. **Проверка Git:**
   - Убедиться, что файлы удалены
   - Проверить статус изменений

---

## Технические требования

- **Полнота удаления:** Все файлы и упоминания CRest должны быть удалены или обновлены
- **Работоспособность:** Проект должен работать без CRest
- **Документация:** Вся документация должна быть актуальной

---

## Критерии приёмки

- [ ] Файл `crest.php` удален
- [ ] Файл `settings.php` удален или обновлен (если не нужен)
- [ ] Все упоминания CRest в коде удалены или обновлены
- [ ] Все упоминания CRest в документации обновлены
- [ ] README.md обновлен
- [ ] Технологический стек обновлен
- [ ] Примеры кода обновлены
- [ ] История изменений обновлена
- [ ] Поиск CRest не находит использований в коде
- [ ] Проект работает без CRest
- [ ] Нет ошибок в логах

---

## Тестирование

### 1. Проверка удаления файлов
```bash
ls -la APP-B24/crest.php
# Должен вернуть "No such file or directory"
```

### 2. Проверка поиска CRest
```bash
grep -r "CRest" APP-B24/src/
# Должен вернуть пустой результат (или только в комментариях)
```

### 3. Проверка работоспособности
```bash
# Открыть все страницы в браузере
# Должны работать без ошибок
```

### 4. Проверка логов
```bash
tail -n 100 APP-B24/logs/*.log
# Не должно быть ошибок, связанных с CRest
```

---

## Риски и митигация

### Риск 1: Пропущенные файлы
**Митигация:** Тщательный поиск, проверка всех директорий

### Риск 2: Проблемы после удаления
**Митигация:** Тестирование всех функций, возможность отката через Git

### Риск 3: Устаревшая документация
**Митигация:** Проверка всех документов, обновление примеров

---

## История правок

- **2025-12-20 19:48 (UTC+3, Брест):** Создана задача на удаление CRest
- **2025-12-20 22:00 (UTC+3, Брест):** Задача выполнена:
  - Удален файл `crest.php`
  - Удален файл `src/Clients/Bitrix24Client.php`
  - Обновлен `tools/checkserver.php` для использования b24phpsdk
  - Обновлены комментарии в коде
  - Обновлена документация (README.md, tech-stack.md, api-structure.md)
  - Все упоминания CRest удалены или обновлены

---

**Связанные документы:**
- [TASK-000-crest-to-b24phpsdk-overview.md](TASK-000-crest-to-b24phpsdk-overview.md) — обзор миграции
- [TASK-006-test-migration.md](TASK-006-test-migration.md) — тестирование миграции

---

**Версия документа:** 1.0  
**Последнее обновление:** 2025-12-20 19:48 (UTC+3, Брест)

